#!/usr/bin/env bash
acpi=$(acpi)

if [[ "$acpi" == *"Battery 1"* ]]; then
    # Battery 1 is present, so we need to check 
    # which of Battery 1 or 0 that has a double digit %.
    bat0=$(echo "$acpi" | grep "Battery 0" | tr " " "\n" | sed -n '4p')
    bat1=$(echo "$acpi" | grep "Battery 1" | tr " " "\n" | sed -n '4p') 
    if [[ "${#bat0}" -lt "${#bat1}" ]]; then
        # bat1 is correct
        txt=$(echo "$acpi" | grep "Battery 1" |  sed "s/,//g" | awk '{if ($3 == "Discharging"){print "󰂃 " $4; exit} else { print "󰁹 " $4 }}' | tr -d "\n")
        echo "$txt"
    else
        # bat0 is correct
        txt=$(echo "$acpi" | grep "Battery 0" |  sed "s/,//g" | awk '{if ($3 == "Discharging"){print "󰂃 " $4; exit} else { print "󰁹 " $4 }}' | tr -d "\n")
        echo "$txt"
    fi      
else
    # If Battery 1 is not present, just use Battery 0.
    txt=$(echo "$acpi" | grep "Battery 0" |  sed "s/,//g" | awk '{if ($3 == "Discharging"){print "󰂃 " $4; exit} else { print "󰁹 " $4 }}' | tr -d "\n")
    echo "$txt"
fi
